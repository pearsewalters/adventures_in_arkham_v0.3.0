investigator_constants = [
    [ 'name',	'nickname',	'occupation',	'home',	'ability_name',	'ability_description',	'story',	'expansion' ],
    ['Amanda Sharpe', 'Amanda', 'the Student', 'Bank of Arkham', 'Studious', 'Whenever Amanda draws one or more cards from the Skill deck, she draws one extra card and then discards one of the cards.', "Amanda has been a student at Miskatonic University for 2 years now. On her way to talk to one of her professors last month, she saw a painting in the hallway that captured her attention with its hazy depiction of some horrible creature rising up out of the ocean. Ever since, Amanda has heard strange whispers in a foreign language whenever her attention drifts. More disturbingly, she has begun to dream of the vast green depths of the ocean and terrible alien cities that lie in its darkest crevasses.\n\nThis evening, as she finishes her shift as a bank teller at the First Bank of Arkham, something out of the night calls to her-- something dark and sinister that leaves the feel of sea foam in her mind and makes her gasp with the effort of resisting it. Leaning against the brick wall of the bank, Amanda realizes that she has to find out what's happening to her or she's going to fall prey to whatever alien presence is invading her mind.", 'base'],
    ['"Ashcan" Pete', 'Pete', 'the Drifter', 'River Docks', 'Scrounge', 'When Pete draws from the Common Item, Unique Item, or Spell Deck, he may draw from either the top or the bottom of that deck, his choice. Pete may look at the bottom card of those decks at any time.', "When you've lived on the streets as long as Pete has, you see things. Things that would drive braver men screaming into the night. But you also learn to be quiet, to stay hidden, and to play stupid if all else fails. It also helps to have a good dog, like Duke, to scare away the meaner elements of the street.\n\nUnfortunately, this time, Pete can't hide, and there's nothing Duke can do to protect him. His nightmares have been growing steadily worse over the last month, driving him all the way here... to Arkham. Even the whiskey isn't helping much anymore. Soon, he won't be able to sleep at all. Still, there are always opportunities for a man who knows how to stay quiet... as long as he isn't too picky.", 'base'],
    ['Bob Jenkins', 'Bob', 'the Salesman', 'General Store', 'Shrewd Dealer', 'Any Phase: Whenever Bob draws one or more cards from the Common item deck, he draws one extra card and then discards one of the cards.', 'As a traveling salesman, Bob is always on the go. But yesterday, he saw something that made him decide to stay in Arkham and miss his train. While he was in the General Store selling his wares, a robed man came in and bought several items, paying with old gold coins. Astounded, Bob turned to the shopkeeper for an explanation, but the man just ignored his questions, simply saying, "That happens, sometimes."\n\nNow, Bob isn\'t leaving until he figues out where those gold coins came from. If he plays his cards right, maybe this will be the big score. Maybe he\'ll finally be able to retire and buy that boat he\'s had his eye on and spend the rest of his days fishing in a tropical paradise. Then again, moybe Bob will finally come to see that all that glitters is not gold.', 'base'],
    ['Carolyn Fern', 'Dr. Fern', 'the Psychologist', 'Arkham Asylum', 'Psychology', "Upkeep: Dr. Fern may restore 1 Sanity to herself or another character in her location. She cannot raise a character's Sanity higher than that character's maximum Sanity.", 'Carolyn is a first year resident at a sanitarium in Providence. Over the past six months, she has been studying the dreams of her patients using hypnosis. One patient in particular gave her vivid and disturbing descriptions of his dreams, right up until he was murdered with a strange knife that closely resembled something from one of his nightmares.\n\nDisturbed and frightened by his murder, Carolyn dug back through her notes, poring over them late into the night. Finally, she found some subtle clues that led her here, to Arkham, where he was previously an inmate in Arkham Asylum. Someone here has to know why a harmless man was murdered for talking about his dreams to his psychologist.', 'base'],
    ['Darrell Simmons', 'Darrell', 'the Photographer', 'Newspaper', 'Hometown Advantage', 'Arkham Encounters: When drawing location encounters in Arkham, Darrell draws two cards and may choose whichever one of the two he wants. This ability does not work when drawing gate encounters in Other Worlds.', "Even while growing up in Arkham, Darrell always knew that there was something not quite right about the strange little town. After graduating from high school, he went to work for the Arkham Advertiser as a photographer, and in the years since, he's crawled over every square inch of the city.\n\nLast night, however, Darrell saw something horrible-- something that has shaken his world to its core and torn away the safe illusions we all foster to protect our minds and our souls. His editor says he was just seeing things, but as he leaves the newspaper building, he knows just what he saw and he intends to show the world! This time he'll be more careful. This time he'll take pictures and prove that things are not normal in Arkham.", 'base'],
    ['Dexter Drake', 'Dexter', 'the Magician', 'Ye Olde Magick Shoppe', 'Magical Gift', 'Any Phase: Whenever "The Great" Drake draws one or more cards from the Spell deck, he draws one extra card and then discards one of the cards.', 'After returning from his stint in the army during WWI, Dexter became a stage magician, and proved to be very successful at his trade, but he always longed to find real magic. As they say, be careful what you wish for. Years later, in a rundown store, Dexter came across a burnt and torn fragment of the Necronomicon itself. Intrigued by this ancient piece of occult knowledge, Dexter began to use his wealth in search of the truth about the ancient lore, and what he found horrified him.\n\nNow, the more he learns, the less he wants to know, but his studies have led him to believe that a great evil will soon arise in Arkham. He knows that he may well be the only person with the ability to stop this evil from swallowing the world, so he has come to that sleepy town to speak with the proprietor of Ye Olde Magick Shoppe, one of the few magic shops that contain true lore, and not merely the stage tricks he once studied.', 'base'],
    ['Gloria Goldberg', 'Gloria', 'the Author', "Velma's Diner", 'Psychic Sensitivity', "Other World Encounter: When drawing location encounters in Other Worlds, Glorial draws two cards that match the color of one of the Other World's encounter symbols, then chooses whichever one of the two she wants. This ability does not work when drawing location encounters in Arkham.", "As a young girl, Gloria was haunted by terrible visions. After years of visiting doctors and some therapy, she learned to control her visions somewhat by writing stories. Her weird and disturbing fiction somehow spoke to the public in these troubled times, and has made her a bestselling writer.\n\nThis evening, while leaving a book signing she's attending in Arkham, she was knocked to the ground by the most powerful vision she's ever experienced. Gloria saw the sky tear open, and a huge and montrous form pour out of the very air itself, wreaking untold havoc and killing thousands. As she sat on the ground with her arms wrapped around herself, Gloria knew, somehow, that this vision was real, and that it would come to pass unless she did something about it.\n\nNow, she finds herself in a run-down diner, sipping coffee and trying to decide what to do.", 'base'],
    ['Harvey Walters', 'Professor Walters', 'the Professor', 'Administration Building', 'Strong Mind', 'Any Phase: Harvey reduces all Sanity losses he suffers by 1, to a minumum of 0.', "Harvey is a visiting Professor at Miskatonic University. With Doctorates in History and Archaeology, he has uncovered several interesting artifacts over the years and learned a little of the arcane arts. Recently, by carefully studying the papers and talking to people in the streets, he has begun to detect a disturbance in the city-- something that could potentially herald the arrival of something unthinkable from beyond time and space.\n\nChecking his notes, Professor Walters prepares himself for one last trip into the streets of Arkham to confirm his theory. If he's right, it could spell the end of everything.", 'base'],
    ['Jenny Barnes', 'Ms. Barnes', 'the Dilettante', 'Train Station', 'Trust Fund', 'Upkeep: Jenny gains $1', "The job sounded simple enough-- pick up a statue at the Providence Museum and deliver it to a guy at the Silver Twilight Lodge. The money was good, and the dame who gave him the job seemed sincere.\n\nSadly, things never seem to work out that easily for Joe. Now the statue is missing, two people are dead, strange cultists are on his tail, and all clues lead to Arkham. Lady Luck can be funny that way.\n\nHe's already tried talking to the Sheriff, but that flatfoot proved to be worse than useless. Looks like it's once again going to be up to Joe Diamond to solve the case.", 'base'],
    ['Joe Diamond', 'Joe', 'the Private Eye', 'Police Station', 'Hunches', 'Any Phase: Joe rolls one extra bonus die when heh spends a Clue token to add to a roll', "A brilliant researcher, but a shy, lonely person, Kate Winthrop has been working at the Miskatonic Science Labs for 4 years now and her supervisor still doesn't know her name. That doesn't matter to her though, as she has been working to complete a private quest for most of that time. Almost 3 years ago, she watched as a device malfunctioned, and Professor Young, her long-time mentor and friend, was torn apart by an indistinct creature that shrieked and gibbered before vanishing into the night. Since then, she has delved into darker scientific studies, always hoping to find something that would allow her to find and defeat that creature along with others of its kind.\n\nTonight, her research has finally paid off, allowing her to create a device that can defeat the alien beings she has detected in Arkham!", 'base'],
    ['Kate Winthrop', 'Dr. Winthrop', 'the Scientist', 'Science Building', 'Science!', "Any Phase: Gates annd monsters cannot appear in Kate's location due to her flux stabilizer. Monsters and gates do not disappear if she enters their location, however, and monsters can move into her location as usual.", "A brilliant researcher, but a shy, lonely person, Kate Winthrop has been working at the Miskatonic Science Labs for 4 years now and her supervisor still doesn't know her name. That doesn't matter to her though, as she has been working to complete a private quest for most of that time. Almost 3 years ago, she watched as a device malfunctioned, and Professor Young, her long-time mentor and friend, was torn apart by an indistinct creature that shrieked and gibbered before vanishing into the night. Since then, she has delved into darker scientific studies, always hoping to find something that would allow her to find and defeat that creature along with others of its kind.\n\nTonight, her research has finally paid off, allowing her to create a device that can defeat the alien beings she has detected in Arkham!", 'base'],
    ['Mandy Thompson', 'Mandy', 'the Researcher', 'Library', 'Research', 'Any Phase: Once per turn, Mandy can activate this ability after any investigator, including herself, makes a skill check. That investigator then re-rolls all of the dice rolled for that check that did not result in successes.', 'Mandy came to Arkham several years ago looking for work as a researcher for Miskatonic University. Since then, she has worked with many of the University professors, delving into esoteric tomes filled with scientific information, historical reports, and sometimes even occult ramblings.\n\nIt was while reading an old book of prophecies last week that she first felt that she had stumbled onto something big. Mandy came to believe that certain signs and portents described in the book were taking place in Arkham right now-- omens that indicated the return of a terrible being reffered to as an Ancient One, which would grind the cities of Man beneath its loathsome tread.\n\nTonight, the full moon has turned blood red, which is the final omen of the return of the Ancient One. Slipping into the night, and armed with her knowledge of the prophecy, Mandy has decided to see if she can defy fate and stop these events from taking place.', 'base'],
    ['Michael McGlen', 'Michael', 'the Gangster', "Ma's Boarding House", 'Strong Body', 'Any Phase: Michael reduces all Stamina losses he suffers by 1, to a minimum of 0.', "As a soldier in the O'Bannion gang, Michael didn't really believe in all this voodoo mumbo jumbo around town. Or at least, he didn't until the night of the Foreman job, when he saw Fast Louie Farrell pulled screaming into the river by a scaly green creature. As they say, seeing is believing and Michael is starting to believe.\n\n\nNow, he has gathered his belongings together in the room that he rents at Ma's Boarding House. Louie was a friend of his, and he won't rest until he finds out what's happening in this town and avenges his buddy ...", 'base'],
    ['Monterey Jack', 'Monterey', 'the Archeologist', 'Curiositie Shoppe', 'Archaeology', 'Any Phase: Whenever Monterey draws one of more cards fromo the Unique item deck, he draws one extra card and then discards one of the cards.', "Monterey has been a globe-trotting treasure hunter and adventurer for many years. Following in his father's footsteps, he's always tried to ensure that the specific value of his finds is preserved. Recently, he followed a lead on an odd prehistoric statue to Arkham. However, when he arrived, the man he came to buy the statue from was locked up in the asylum. Monterey was just about to give up and go home in disgust when a robed figure pushed past him.\n\n\nFor just an instant, there was a flash of a silver pendant with a symbol on it Monterey would never forget. That symbol had been carved into his murdered father's forehead, and had haunted his dreams for years.\n\nChasing after the mysterious figure, he turned a corner only to discover that he had lost his quarry.\n\nHowever, Monterey knows that somewhere in Arkham may lie the answer to the mystery of his father's murder, and he's not leaving until he finds it.", 'base'],
    ['Sister Mary', 'Mary', 'the Nun', 'South Church', 'Guardian Angel', "Any Phase: Sister Mary is never Lost in Time & Space. Instead, if her Sanity is 0, she returns to Arkham Asylum. If her Stamina, she returns to St. Mary's Hospital. If neither her Sanity nor her Stamina are 0, she returns to South Church.", "Sister Mary has served the Church faithfully for many years, so when she was sent to Arkham to work with Father Michael, a man whose writings she had admired for many years, she felt that she was truly blessed. Now, after witnessing Father Michael's strange mood swings and seeing some of the bizarre practices that go on in this town, she's beginning to feel that she may have been a bit too hasty ...\n\nFor instance, last night, there was a knock on the door of the church, and when she answered it, there was nothing but a handwritten journal laying on the steps outside. Reading it, she learned of strange cults and terrible creatures that lurk in the darkness. Worse, when she laughingly showed it to Father Michael, he turned pale and threw it into the fire, yelling at her to forget what she'd seen.\n\nNow, gathering her things and quietly leaving South Church, Sister Mary has decided to investigate this town, and in so doing, reaffirm her faith.", 'base'],
    ['Vincent Lee', 'Dr. Lee', 'the Doctor', "St. Mary's Hospital", 'Physician', "Upkeep: Dr. Lee may restore 1 Stamina to himself or another character in his location. He cannot raise a character's Stamina higher than that character's maximum Stamina.", "A Yale graduate of Medicine, Vincent has recently moved to Arkham from Boston to practice at St. Mary's Hospital. Since his coming to Arkham, he has seen far too many horrible and unexplained deaths - an elderly victim torn apart by unknown wild animals, a healthy young man whose heart exploded, and so many others. Their faces haunt his dreams, especially the young man's terrified expression. After all this, small wonder that Vincent has begun to wonder if there's something sinister going on in this quiet Massachusetts town.\n\nTonight Dr. Lee made the decision to investigate the mysteries of Arkham and stop the strange deaths. He is determined to see this through, even if in so doing he becomes another puzzle for the next doctor who comes to Arkham.", 'base'],
]

investigator_defaults = [
    ['name',            'damage',  'horror',  'conditions',             'focus',   'speed',   'fight',   'lore',    'location', 'random_possessions', 'equipped_items', 'exhausted_items', 'possessions'],
    ['Amanda Sharpe',   [5, 0, 0], [5, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [4, 4, 5], [4, 4, 5], [4, 4, 5], [19, 0, 1], [1, 1, 1, 2],         [2, []],          [],                {'money': 1, 'clues': 1, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['"Ashcan" Pete',   [5, 0, 0], [5, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0], [3, 3, 6], [5, 5, 7], [3, 3, 3], [11, 0, 1], [1, 1, 0, 1],         [2, []],          [],                {'money': 1, 'clues': 3, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': ['Duke']}],
    ['Bob Jenkins',     [6, 0, 0], [4, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0], [5, 5, 5], [4, 4, 7], [3, 3, 4], [15, 0, 1], [2, 2, 0, 1],         [2, []],          [],                {'money': 9, 'clues': 0, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Carolyn Fern',    [4, 0, 0], [6, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [3, 3, 3], [4, 4, 5], [5, 5, 7], [4, 0, 1],  [2, 2, 0, 1],         [2, []],          [],                {'money': 7, 'clues': 1, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Darrell Simmons', [6, 0, 0], [4, 0, 0], [0, 0, 0, 1, 0, 0, 0, 0], [2, 2, 0], [5, 5, 5], [5, 5, 6], [3, 3, 4], [2, 0, 1],  [1, 2, 0, 1],         [2, []],          [],                {'money': 4, 'clues': 1, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Dexter Drake',    [5, 0, 0], [5, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [5, 5, 6], [4, 4, 4], [5, 5, 5], [25, 0, 1], [1, 1, 2, 1],         [2, []],          [],                {'money': 5, 'clues': 0, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': ['Shrivelling'], 'buffs': [], 'allies': []}],
    ['Gloria Goldberg', [4, 0, 0], [6, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [4, 4, 4], [3, 3, 5], [4, 4, 6], [10, 0, 1], [2, 0, 2, 1],         [2, []],          [],                {'money': 7, 'clues': 2, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Harvey Walters',  [3, 0, 0], [7, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [3, 3, 5], [3, 3, 3], [6, 6, 7], [17, 0, 1], [0, 2, 2, 1],         [2, []],          [],                {'money': 5, 'clues': 1, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Jenny Barnes',    [4, 0, 0], [6, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0], [3, 3, 4], [4, 4, 6], [4, 4, 6], [3, 0, 1],  [2, 1, 1, 1],         [2, []],          [],                {'money': 10, 'clues': 0, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Joe Diamond',     [6, 0, 0], [4, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [3, 3, 0], [6, 6, 7], [5, 5, 5], [3, 3, 0], [8, 0, 1],  [2, 0, 0, 1],         [2, []],          [],                {'money': 8, 'clues': 3, 'gate_trophies': 0, 'monster_trophies': 0, 'common': ['.45 Automatic'], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Kate Winthrop',   [4, 0, 0], [6, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0], [4, 4, 6], [4, 4, 4], [5, 5, 6], [18, 0, 1], [1, 1, 2, 1],         [2, []],          [],                {'money': 7, 'clues': 2, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Mandy Thompson',  [5, 0, 0], [5, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [4, 4, 6], [3, 3, 5], [4, 4, 4], [19, 0, 1], [2, 1, 0, 1],         [2, []],          [],                {'money': 6, 'clues': 4, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Michael McGlen',  [7, 0, 0], [3, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 0], [5, 5, 6], [6, 6, 7], [3, 3, 3], [26, 0, 1], [0, 1, 0, 1],         [2, []],          [],                {'money': 8, 'clues': 0, 'gate_trophies': 0, 'monster_trophies': 0, 'common': ['Dynamite', 'Tommy Gun'], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Monterey Jack',   [7, 0, 0], [3, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [4, 4, 4], [5, 5, 5], [4, 4, 6], [1, 0, 1],  [0, 2, 0, 1],         [2, []],          [],                {'money': 7, 'clues': 1, 'gate_trophies': 0, 'monster_trophies': 0, 'common': ['Bullwhip', '.38 Revolver'], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}],
    ['Sister Mary',     [3, 0, 0], [7, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1], [1, 1, 0], [4, 4, 5], [3, 3, 4], [4, 4, 7], [28, 0, 1], [0, 0, 2, 1],         [2, []],          [],                {'money': 0, 'clues': 0, 'gate_trophies': 0, 'monster_trophies': 0, 'common': ['Cross'], 'unique': ['Holy Water'], 'spells': [], 'buffs': [], 'allies': []}],
    ['Vincent Lee',     [5, 0, 0], [5, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [2, 2, 0], [3, 3, 5], [3, 3, 4], [5, 5, 6], [23, 0, 1], [2, 0, 2, 1],         [2, []],          [],                {'money': 9, 'clues': 1, 'gate_trophies': 0, 'monster_trophies': 0, 'common': [], 'unique': [], 'spells': [], 'buffs': [], 'allies': []}]
]

investigator_transforms = [
    [ 'name','damage','horror','conditions','focus','speed','fight','lore','location','random_possessions','equipped_items','exhausted_items','possessions'],
    ['Amanda Sharpe', [], [], [], [], [], [], [], [], [], [], [], [] ],
    ['"Ashcan" Pete', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Bob Jenkins', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Carolyn Fern', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Darrell Simmons', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Dexter Drake', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Gloria Goldberg', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Harvey Walters', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Jenny Barnes', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Joe Diamond', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Kate Winthrop', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Mandy Thompson', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Michael McGlen', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Monterey Jack', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Sister Mary', [], [], [], [], [], [], [], [], [], [], [], []],
    ['Vincent Lee',[], [], [], [], [], [], [], [], [], [], [], [] ]
]

# transformers

# health

def inc_health_stat( matrix ):
    return [ matrix[0], matrix[1] + 1, matrix[2] ]

def dec_health_stat( matrix ):
    return [ matrix[0], matrix[1] - 1, matrix[2] ]

def current_stat( matrix, transformations ):
    stat = matrix
    for transformation in transformations:
        stat = transformation( stat )
    return stat

def inc_damage( matrix ):
    return [ matrix[0], matrix[1] + 1, matrix[2] ]

def dec_damage( matrix ):
    return [ matrix[0], matrix[1] - 1, matrix[2] ]

def inc_max_damage( matrix ):
    return [ matrix[0] + 1, matrix[1], matrix[2] ]

def dec_max_damage( matrix ):
    return [ matrix[0] - 1, matrix[1], matrix[2] ]

def inc_horror( matrix ):
    return inc_damage( matrix )

def dec_horror( matrix ):
    return dec_damage( matrix )

def inc_max_horror( matrix ):
    return inc_max_damage( matrix )

def dec_max_horror( matrix ):
    return dec_max_damage( matrix )

def set_uncon( matrix ):
    return [ matrix[0], matrix[1], matrix[2] + 1 ]

def set_con( matrix ):
    return [ matrix[0], matrix[1], matrix[2] - 1 ]

def set_insane( matrix ):
    return set_uncon( matrix )

def set_sane( matrix ):
    return set_con( matrix )

# conditions

current_condtions = current_stat

def add_delay( matrix ):
    return [ c+1 if matrix.index(c) == 0 else c for c in matrix if matrix ]

def remove_delay( matrix ):
    return [ c-1 if matrix.index(c) == 0 else c for c in matrix if matrix ]

def add_arrest( matrix ):
    return [ c+1 if matrix.index(c) == 1 else c for c in matrix if matrix ]

def remove_arrest( matrix ):
    return [ c-1 if matrix.index(c) == 1 else c for c in matrix if matrix ]

def add_lost( matrix ):
    return [ c+1 if matrix.index(c) == 2 else c for c in matrix if matrix ]

def remove_lost( matrix ):
    return [ c-1 if matrix.index(c) == 2 else c for c in matrix if matrix ]

def add_retainer( matrix ):
    return [ c+1 if matrix.index(c) == 3 else c for c in matrix if matrix ]

def remove_retainer( matrix ):
    return [ c-1 if matrix.index(c) == 3 else c for c in matrix if matrix ]

def add_bank_loan( matrix ):
    return [ c+1 if matrix.index(c) == 4 else c for c in matrix if matrix ]

def remove_bank_loan( matrix ):
    return [ c-1 if matrix.index(c) == 4 else c for c in matrix if matrix ]

def add_stl_membership( matrix ):
    return [ c+1 if matrix.index(c) == 5 else c for c in matrix if matrix ]

def remove_stl_membership( matrix ):
    return [ c-1 if matrix.index(c) == 5 else c for c in matrix if matrix ]

def add_deputy( matrix ):
    return [ c+1 if matrix.index(c) == 6 else c for c in matrix if matrix ]

def remove_deputy( matrix ):
    return [ c-1 if matrix.index(c) == 6 else c for c in matrix if matrix ]

def add_blessing( matrix ):
    return [ c+1 if matrix.index(c) == 7 else c for c in matrix if matrix ]

def remove_blessing( matrix):
    return [ c-1 if matrix.index(c) == 7 else c for c in matrix if matrix ]

def add_curse( matrix ):
    return remove_blessing( matrix )

def remove_curse( matrix ):
    return add_blessing( matrix )

# skills

def inc_skill( matrix ):
    return [ matrix[0], matrix[1]+1, matrix[2] ]

def dec_skill( matrix ):
    return [ matrix[0], matrix[1]-1, matrix[2] ]

def current_skill( matrix, transformations ):
    return current_stat( matrix, transformations)

def current_complement_skill( matrix, transformations):
    return matrix[2] - current_skill( matrix, transformations )[1]

def inc_focus( matrix ):
    return inc_skill( matrix )

def dec_focus( matrix ):
    return dec_skill( matrix )

def inc_speed( matrix ):
    return inc_skill( matrix )

def dec_speed( matrix ):
    return dec_skill( matrix )

def inc_fight( matrix ):
    return inc_skill( matrix )

def dec_fight( matrix ):
    return dec_skill( matrix )

def inc_lore( matrix ):
    return inc_skill( matrix )

def dec_lore( matrix ):
    return dec_skill( matrix )

def inc_sneak( matrix ):
    return dec_skill( matrix )

def dec_sneak( matrix ):
    return inc_skill( matrix )

def inc_will( matrix ):
    return dec_skill( matrix )

def dec_will( matrix ):
    return inc_skill( matrix )

def inc_luck( matrix ):
    return dec_skill( matrix )

def dec_luck( matrix ):
    return inc_skill( matrix )

# locational

def change_loc( matrix, new_loc ):
    return [ new_loc, matrix[1], matrix[2] ]

def move_to_CURIOSITIE_SHOPPE( matrix ):
    return change_loc( matrix, 1 )

def move_to_NEWSPAPER( matrix ):
    return change_loc( matrix, 2 )

def move_to_TRAIN_STATION( matrix ):
    return change_loc( matrix, 3 )

def move_to_NORTHSIDE_STREETS( matrix ):
    return change_loc( matrix, 29 )

def move_to_ARKHAM_ASYLUM( matrix ):
    return change_loc( matrix, 4 )

def move_to_BANK_OF_ARKHAM( matrix ):
    return change_loc( matrix, 5 )

def move_to_INDEPENDENCE_SQUARE( matrix ):
    return change_loc( matrix, 6)

def move_to_DOWNTOWN_STREETS( matrix ):
    return change_loc( matrix, 30)

def move_to_HIBBS_ROADHOUSE( matrix ):
    return change_loc( matrix, 7 )

def move_to_POLICE_STATION( matrix ):
    return change_loc( matrix, 8 )

def move_to_JAIL( matrix ):
    return change_loc( matrix, 9)

def move_to_VELMAS_DINER( matrix ):
    return change_loc( matrix, 10)

def move_to_DOWNTOWN_STREETS( matrix ):
    return change_loc( matrix, 31)

def move_to_RIVER_DOCKS( matrix ):
    return change_loc( matrix, 11 )

def move_to_THE_UNNAMEABLE( matrix ):
    return change_loc( matrix, 12 )

def move_to_UNVISITED_ISLE( matrix ):
    return change_loc( matrix, 13)

def move_to_MERCHANT_DISTRICT_STREETS( matrix ):
    return change_loc( matrix, 32)

def move_to_BLACK_CAVE( matrix ):
    return change_loc( matrix, 14 )

def move_to_GENERAL_STORE( matrix ):
    return change_loc( matrix, 15 )

def move_to_GRAVEYARD( matrix ):
    return change_loc( matrix, 16)

def move_to_RIVERTOWN_STREETS( matrix ):
    return change_loc( matrix, 33)

def move_to_ADMINISTRATION( matrix ):
    return change_loc( matrix, 17 )

def move_to_SCIENCE_BUILDING( matrix ):
    return change_loc( matrix, 18 )

def move_to_LIBRARY( matrix ):
    return change_loc( matrix, 19)

def move_to_MISKATONIC_UNIVERSITY_STREETS( matrix ):
    return change_loc( matrix, 34)

def move_to_THE_WITCH_HOUSE( matrix ):
    return change_loc( matrix, 20 )

def move_to_THE_SILVER_TWILIGHT_LODGE( matrix ):
    return change_loc( matrix, 21 )

def move_to_THE_INNER_SANCTUM( matrix ):
    return change_loc( matrix, 22)

def move_to_FRENCH_HILL_STREETS( matrix ):
    return change_loc( matrix, 35)

def move_to_ST_MARYS_HOSPITAL( matrix ):
    return change_loc( matrix, 23 )
def move_to_WOODS( matrix ):
    return change_loc( matrix, 24 )

def move_to_YE_OLDE_MAGICK_SHOPPE( matrix ):
    return change_loc( matrix, 25)

def move_to_UPTOWN_STREETS( matrix ):
    return change_loc( matrix, 36)

def move_to_MAS_BOARDING_HOUSE( matrix ):
    return change_loc( matrix, 26 )

def move_to_HISTORICAL_SOCIETY( matrix ):
    return change_loc( matrix, 27 )

def move_to_SOUTH_CHURCH( matrix ):
    return change_loc( matrix, 28)

def move_to_SOUTHSIDE_STREETS( matrix ):
    return change_loc( matrix, 37)

def inc_movement( matrix ):
    return [ matrix[0], matrix[1]+1, matrix[2] ]

def dec_movement( matrix ):
    return [ matrix[0], matrix[1]-1, matrix[2] ]

def set_in_arkham( matrix ):
    return [ matrix[0], matrix[1], matrix[2]+1 ]

def set_in_other_world( matrix ):
    return [ matrix[0], matrix[1], matrix[2]-1 ]

current_location = current_stat

# equipment

def inc_hands( matrix ):
    return [ matrix[0]+1, matrix[2] ]

def dec_hands( matrix ):
    return [ matrix[0]-1, matrix[2] ]

def equip_item( matrix, item ):
    return [ matrix[0], matrix[1]+[item] ]

def unequip( matrix, item ):
    return matrix[:matrix.index(item)] + matrix[matrix.index(item)+1:]

# exhausted items

def exhaust_item( matrix, item ):
    return matrix + [item]

def refresh_items( matrix ):
    return matrix[:0]

# possessions
def current_possessions( dictionary, transformations ):
    d = dictionary
    for transformation in transformations:
        d = transformation[0]( d, transformation[1] ) if hasattr( transformation, '__iter__' ) else transformation( d )
    return d

def inc_money( dictionary ):
    return { k:(v+1 if k == 'money' else v) for k,v in dictionary.items() }

def dec_money( dictionary ):
    return { k:(v-1 if k == 'money' else v) for k,v in dictionary.items() }

def inc_clues( dictionary ):
    return { k:(v+1 if k == 'clues' else v) for k,v in dictionary.items() }

def dec_clues( dictionary ):
    return { k:(v-1 if k == 'clues' else v) for k,v in dictionary.items() }

def inc_gate_trophies( dictionary ):
    return { k:(v+1 if k == 'gate_trophies' else v) for k,v in dictionary.items() }

def dec_gate_trophies( dictionary ):
    return { k:(v-1 if k == 'gate_trophies' else v) for k,v in dictionary.items() }

def inc_monster_trophies( dictionary ):
    return { k:(v+1 if k == 'monster_trophies' else v) for k,v in dictionary.items() }

def dec_monster_trophies( dictionary ):
    return { k:(v-1 if k == 'monster_trophies' else v) for k,v in dictionary.items() }

def add_item( dictionary, variety, item ):
    return { k:(v+[item] if k == variety else v) for k,v in dictionary.items() }

def remove_item( dictionary, variety, item ):
    return { k:( v[:v.index(item)] + v[v.index(item)+1:] if k == variety else v) for k,v in dictionary.items() }

def add_common_item( dictionary, item ):
    return add_item( dictionary, 'common', item )

def remove_common_item( dictionary, item ):
    return remove_item( dictionary, 'common', item )

def add_unique_item( dictionary, item ):
    return add_item( dictionary, 'unique', item )

def remove_unique_item( dictionary, item ):
    return remove_item( dictionary, 'unique', item )

def add_spell( dictionary, spell ):
    return add_item( dictionary, 'spells', spell )

def remove_spell( dictionary, spell ):
    return remove_item( dictionary, 'spells', spell )

def add_buff( dictionary, buff  ):
    return add_item( dictionary, 'buffs', buff )

def remove_buff( dictionary, buff ):
    return remove_item( dictionary, 'buffs', buff )

def add_ally( dictionary, ally ):
    return add_item( dictionary, 'allies', ally )

def remove_ally( dictionary, ally ):
    return remove_item( dictionary, 'allies', ally )

current_possessions = current_equipment = current_exhausted = current_stat

# validators

def damage_constraint( matrix, next_transform, prev_transforms ):
    """
        DAMAGE:
        A Character who receives greater than or equal to their max_damage becomes unconscious. 
        A Character cannot remove damage to less than 0. 

        This validator returns 0 if the Character's damage is on the interval (-inf, 0)
                               1 if the Character's damage is on the interval [0, max), or
                               2 if the Character's damage is on the interval [max, inf) 
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms ) )
    # damage can't less than 0 or greater than max
    if 0 <= transformed_matrix[1] <= transformed_matrix[0]:
        return 1
    # character is unconscious if max damage is reached
    elif transformed_matrix[1] > transformed_matrix[0]:
        return 2
    # otherwise, invalid transform
    else:
        return 0
    
def horror_constraint( matrix, next_transform, prev_transforms ):
    """
        HORROR:
        A Character who receives greater than or equal to their max_horror becomes insane. 
        A Character cannot remove horror to less than 0. 

        This validator returns 0 if the Character's horror is on the interval (-inf, 0)
                               1 if the Character's horror is on the interval [0, max), or
                               2 if the Character's horror is on the interval [max, inf) 
    """
    return damage_constraint( matrix, next_transform, prev_transforms )

def unconscious_constraint( matrix, next_transform, prev_transforms ):
    """
        UNCONCIOUS:
        A Character becomes unconscious if they receive total damage of at least their max damage.
        This stat exists in {0,1}, where 0 is conscious and 1 is unconscious.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms ) )
    # unconscious can only be 0 or 1 
    if 0 <= transformed_matrix[1] <= 1:
        return True
    else:
        return False
    
def insane_constraint( matrix, next_transform, prev_transforms ):
    """
        INSANE:
        A Character becomes insane if they receive total horror of at least their max horror.
        This stat exists in {0,1}, where 0 is sane and 1 is insane.
    """
    return unconscious_constraint( matrix, next_transform, prev_transforms )

def delay_constraint( matrix, next_transform, prev_transforms ):
    """
        DELAYED
        A Character becomes delayed for a number of reasons. If delayed, a Character cannot take their turn until they 
            become undelayed during the following Upkeep phase.
        This stat exists in {0,1} where 0 is undelayed, and 1 is delayed.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    # this value has to be 0 or 1
    if 0 <= transformed_matrix[0] <= 1:
        return True
    else:
        return False
    
def arrest_constraint( matrix, next_transform, prev_transforms ):
    """
        ARRESTED
        A Character can be arrested because of certain in-game events. If arrested, a Character becomes DELAYED.
        This stat exists in {0,1} where 0 is un-arrested, and 1 is arrested.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    # this value has to be 0 or 1
    if 0 <= transformed_matrix[1] <= 1:
        return True
    else:
        return False
    
def lost_constraints( matrix, next_transform, prev_transforms ):
    """
        LOST IN TIME & SPACE
        A Character becomes lost in time & space for a number of reasons. If lost in time & space, a Character becomes DELAYED.
        A Character remains lost in time & space after becoming undelayed until the following Upkeep phase.
        This stat exists in {0,1} where 0 is not lost in time & space, and 1 is lost in time & space.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    # this value has to be 0 or 1
    if 0 <= transformed_matrix[2] <= 1:
        return True
    else:
        return False
    
def retainer_constraints( matrix, next_transform, prev_transforms ):
    """
        RETAINER
        A Character gains a retainer likely from the Newspaper. If a Character has a retainer, they gain $1 every Upkeep.
        After gaining their dollar, there is a chance the Character loses their retainer.
        This stat exists in {0,1} where 0 is 'has no retainer', and 1 is 'has retainer'.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    # this value has to be 0 or 1
    if 0 <= transformed_matrix[3] <= 1:
        return True
    else:
        return False
    
def bank_loan_constraints( matrix, next_transform, prev_transforms ):
    """
        BANK LOAN
        A Character gains a loan from the Bank of Arkham. When a Character gets the loan, 
        they immediately gain $10. If a Character has a loan, there is a chance they must pay 
        $1 or, if unable, lose half their items. If this occurs, the Character may not take
        out another loan.`
        This stat exists in {0,1,inf} where 0 is 'has no bank loan', 1 is 'has bank loan', 
        and inf is 'may not receive a bank loan.
        This constraint check returns 0 if passed a bad transform, 1 if a good transform, and
        2 if a transform on a loan that can't be given.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    # this value has to be 0, 1, or inf
    if 0 <= transformed_matrix[4] <= 1:
        return 1
    elif transformed_matrix[4] == float('inf'):
        return 2
    else:
        return 0
    
def twilight_constraints( matrix, next_transform, prev_transforms ):
    """
        SILVER TWILIGHT LODGE MEMBERSHIP
        A Character gains a lodge membership from the Silver Twilight Lodge. If a Character has 
        a lodge membership, they can optionally have an encounter in the Inner Sanctum.
        This stat exists in {0,1} where 0 is 'has no lodge membership', and 1 is 'has lodge membership'.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    # this value has to be 0 or 1
    if 0 <= transformed_matrix[5] <= 1:
        return True
    else:
        return False

def deputy_constraints( matrix, next_transform, prev_transforms ):
    """
        DEPUTY OF ARKHAM
        A Character is deputized for certain heroic acts. If a Character is a deputy, they 
        immediately gain a Patrol Wagon and a Deputy's Revolver, and they gain $1 every Upkeep.
        This stat exists in {0,1} where 0 is 'not deputized', and 1 is 'deputized'.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    # this value has to be 0 or 1
    if 0 <= transformed_matrix[6] <= 1:
        return True
    else:
        return False
    
def blessed_cursed_constraints( matrix, next_transform, prev_transforms ):
    """
        BLESSED & CURSED
        A Character can receive a blessing or a curse for a number of reasons. This status affects the outcome of skill checks.
        If a Character is cursed and becomes blessed, their condition is now normal (the effects cancel). Similarly, if a Character
            is blessed and becomes cursed, their condition is normal.
        This stat exists in {-1,0,1} where -1 is cursed, 0 is normal, and 1 is blessed.
        This constraint check returns 0 if given a bad transform, 1 if cursed, 2 if normal, and 3 if blessed.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms) )
    if not -1 <= transformed_matrix[7] <= 1:
        return 0 # invalid transform
    elif transformed_matrix[7] == -1:
        return 1 # cursed
    elif transformed_matrix[7] == 0:
        return 2 # normal
    elif transformed_matrix[7] == 1:
        return 3 # blessed
    
def skills_constraint( matrix, next_transform, prev_transforms ):
    """
        SKILLS
        Skills adjustments are bound by the maximum of that skill. The minimum is
            always 3 less than the max, hence the boundary.
    """
    transformed_matrix = next_transform( current_skill( matrix, prev_transforms) )
    # skill must be inside the range defined on the investigator sheets
    if transformed_matrix[0] - 3 <= transformed_matrix[1] <= transformed_matrix[0]:
        return True
    else:
        return False

def focus_constraint( matrix, next_transform, prev_transforms ):
    """
        FOCUS
        Focus is adjusted along with skills. Focus can't be less than 0 or more than 
            the maximum for that player.
    """
    transformed_matrix = next_transform( current_skill( matrix, prev_transforms) )
    # focus can't be less than 0 or greater than the max
    if 0 <= transformed_matrix[1] <= transformed_matrix[0]:
        return True
    else:
        return False

def change_loc_constraint( matrix, next_transform, prev_transforms, adjacency_matrix ):
    """
        CHANGING LOCATION
        Movement is a matter of substituting the current location for a desired location.
        This validator requires an adjacency matrix in order to behave normally.
        It will return true if the locations are adjacent, false if not.
    """
    most_recent_location = current_stat( matrix, prev_transforms )[0]
    transformed_location = next_transform( current_stat( matrix, prev_transforms ) )[0]
    # look at the adjaceny matrix to see if the moves are adjacent
    return bool( adjacency_matrix[most_recent_location][transformed_location] )

def movement_pts_constraint( matrix, next_transform, prev_transforms ):
    """
        MOVEMENT POINTS
        Movement points are spent moving around the map of Arkham (not the Other Worlds).
        They are also spent on certain items, like Tomes, for a chance to gain clues, spells, or items.
        Movement points are assigned every Movement phase, and are based on current Speed, including 
            buffs and allies.
        Movement points cannot be adjusted below 0.
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms ) )
    # can't be less than zero
    if transformed_matrix[1] < 0:
        return False
    else:
        return True

def in_arkham_constraint( matrix, next_transform, prev_transforms ):
    """
        IN ARKHAM
        Certain game effects will only apply to Characters in Arkham (not in Other Worlds).
        This stat exists in {0,1}, where 0 is 'in Other Worlds,' and 1 is 'in Arkham.'
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms ) )
    # can't be less than zero
    if 0 <= transformed_matrix[1] <= 1:
        return True
    else:
        return False
    
def hands_constraint( matrix, next_transform, prev_transforms ):
    """
        HANDS
        Investigators have a standard 2 hands available. Reducing this to less than 0 is illegal.
        Some items or spells may increase the number of hands, but this constraint gives no upper limit.

        Returns True if the proposed transform is 0 <= hands, else returns False
    """
    transformed_matrix = next_transform( current_stat( matrix, prev_transforms ) )
    # can't be less than 0
    if 0 <= transformed_matrix[0]:
        return True
    else:
        return False
    
def money_constraint( dictionary, next_transform, prev_transforms ):
    """
        MONEY
        Money exists in [0,inf). While the analog game has a finite amount of money tokens, 
            right now there is no rule regarding what happens when that pool of tokens runs out.
            Since this is the case, I am assuming there's no reason to believe the money should 
            run out for any reason.
    """
    transformed_dictionary = next_transform( current_possessions( dictionary, prev_transforms ) )
    # can't be less than 0
    if 0 <= transformed_dictionary['money']:
        return True
    else:
        return False

def clues_constraint( dictionary, next_transform, prev_transforms ):
    """
        CLUES
        Clues exists in [0,inf), and so 'negative clues' is illegal. The analog game may have something to 
            say about running out of clue tokens, but I'm choosing to treat clue tokens as an infinite resource.
    """
    transformed_dictionary = next_transform( current_possessions( dictionary, prev_transforms ) )
    # can't be less than 0
    if 0 <= transformed_dictionary['clues']:
        return True
    else:
        return False
    
def gate_trophy_constraint( dictionary, next_transform, prev_transforms ):
    """
        GATE TROPHIES
        Gate trophies exist in [0,num_gates] where num_gates is the number of gate tokens in the game.
        Base game includes 16 gate tokens. Rewrite this constraint when including expansions.
    """
    transformed_dictionary = next_transform( current_possessions( dictionary, prev_transforms ) )
    if 0 <= transformed_dictionary['gate_trophies'] <= 16:
        return True
    else:
        return False
    
def monster_trophy_constraint( dictionary, next_transform, prev_transforms ):
    """
        MONSTER TROPHIES
        Monster trophies exist in [0,num_monsters] where num_monsters is the number of monster tokens in the game.
        Base game includes 55 regular monsters. 
        Rewrite this constraint whenever additional monsters are added, such as Nyarlathotep's masks or including 
            expansions.
    """
    transformed_dictionary = next_transform( current_possessions( dictionary, prev_transforms ) )
    if 0 <= transformed_dictionary['monster_trophies'] <= 55:
        return True
    else:
        return False